<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ãŠä¾¿ã‚Š - Yossyã®ãƒšãƒ³ã‚®ãƒ³ã•ã„ã¨</title>
  <meta name="description" content="Yossyã¸ã®ãŠä¾¿ã‚Šã‚„è³ªå•ã€ç›¸è«‡ã‚’ãŠèãã—ã¾ã™ã€‚å­¦ç¿’ç›¸è«‡ã€æˆæ¥­ã«é–¢ã™ã‚‹ã”è³ªå•ãªã©ã€ãŠæ°—è»½ã«ãŠå¯„ã›ãã ã•ã„ã€‚">
  <meta name="author" content="Yossy">
  <meta name="theme-color" content="#1a2e44">

  <!-- OGP -->
  <meta property="og:title" content="ãŠä¾¿ã‚Š - Yossyã®ãƒšãƒ³ã‚®ãƒ³ã•ã„ã¨">
  <meta property="og:description" content="Yossyã¸ã®ãŠä¾¿ã‚Šã‚„è³ªå•ã‚’ãŠèãã—ã¾ã™ã€‚å­¦ç¿’ç›¸è«‡ã¯ã“ã¡ã‚‰ã‹ã‚‰ã€‚">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://yossy-ac.github.io/YossyHP/contact.html">
  <meta property="og:image" content="https://yossy-ac.github.io/YossyHP/og-image.svg">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="ãŠä¾¿ã‚Š - Yossyã®ãƒšãƒ³ã‚®ãƒ³ã•ã„ã¨">
  <meta name="twitter:description" content="Yossyã¸ã®ãŠä¾¿ã‚Šã‚„è³ªå•ã‚’ãŠèãã—ã¾ã™ã€‚">
  <meta name="twitter:image" content="https://yossy-ac.github.io/YossyHP/og-image.svg">

  <link rel="stylesheet" href="style.css">
  <script>if(localStorage.getItem('theme')==='dark')document.documentElement.setAttribute('data-theme','dark');</script>
</head>
<body>

  <header>
    <div class="header-inner">
      <span class="logo">ğŸ§</span>
      <div>
        <h1><a href="index.html" class="site-title-link">Yossyã®ãƒšãƒ³ã‚®ãƒ³ã•ã„ã¨</a></h1>
        <p class="tagline"><a href="https://www.youtube.com/@yossy0116" target="_blank" rel="noopener noreferrer">ğŸ¥ Yossyã®ãƒšãƒ³ã‚®ãƒ³ã¡ã‚ƒã‚“ã­ã‚‹</a></p>
      </div>
    </div>
    <button class="theme-toggle" id="theme-toggle" title="ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ" aria-label="ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ">ğŸŒ™</button>
  </header>

  <nav class="site-nav">
    <ul>
      <li><a href="index.html">ğŸ  ãƒ›ãƒ¼ãƒ </a></li>
      <li><a href="about.html">ğŸ§ è‡ªå·±ç´¹ä»‹</a></li>
      <li><a href="essay.html">âœï¸ è‹±ä½œæ–‡æ·»å‰Š</a></li>
      <li><a href="contact.html" class="active">ğŸ“ ãŠä¾¿ã‚Š</a></li>
      <li><a href="files-download.html">ğŸ“¥ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</a></li>
    </ul>
  </nav>

  <main>
    <section class="contact-section">
      <h2>ãŠä¾¿ã‚Šãƒ•ã‚©ãƒ¼ãƒ </h2>
      <p class="section-desc">è¿”ç­”ã¯ã‚ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã—ãªã„ã‹ã‚‚ã—ã‚Œãªã„</p>

      <div class="contact-card">
        <form id="contact-form">
          <div class="form-group">
            <label for="name">ãŠåå‰</label>
            <input type="text" id="name" name="name" class="form-input" placeholder="ä¾‹ï¼šå‰å·æ­¦é›„">
          </div>

          <div class="form-group">
            <label for="email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
            <input type="email" id="email" name="email" class="form-input" placeholder="ä¾‹ï¼šmikertom@apex.com">
          </div>

          <div class="form-group">
            <label for="school">é«˜æ ¡å</label>
            <input type="text" id="school" name="school" class="form-input" placeholder="ä¾‹ï¼šéŸ“æ—æ¼”èŠ¸èŠ¸è¡“é«˜ç­‰å­¦æ ¡">
          </div>

          <div class="form-group">
            <label for="grade">å­¦å¹´</label>
            <select id="grade" name="grade" class="form-input">
              <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
              <option value="é«˜1">é«˜1</option>
              <option value="é«˜2">é«˜2</option>
              <option value="é«˜3">é«˜3</option>
              <option value="ãã®ä»–">ãã®ä»–</option>
            </select>
          </div>

          <div class="form-group">
            <label for="university">å¿—æœ›å¤§å­¦</label>
            <input type="text" id="university" name="university" class="form-input" placeholder="ä¾‹ï¼šãƒ‘ãƒƒãƒãƒ£ã‚¤ãƒ¤ãƒƒãƒ‘ãƒ«å¤§å­¦">
          </div>

          <div class="form-group">
            <label for="subject">ä»¶å</label>
            <input type="text" id="subject" name="subject" class="form-input" placeholder="ä¾‹ï¼šåœ°ç„å…«æ™¯äº¡è€…æˆ¯">
          </div>

          <div class="form-group form-group--full">
            <label for="message">å†…å®¹ <span class="required">*</span></label>
            <textarea id="message" name="message" class="form-textarea" rows="8" placeholder="" required></textarea>
          </div>

          <button type="submit" class="btn-submit">ğŸ“¬ é€ä¿¡ã™ã‚‹</button>
        </form>
      </div>

      <div id="success-message" class="success-message" hidden>
        <div class="success-content">
          <p>âœ… ãŠä¾¿ã‚Šã‚’ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼</p>
          <p>ã”è¨˜å…¥ã„ãŸã ã„ãŸå†…å®¹ã‚’ç¢ºèªã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚</p>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <p>ğŸ§ Yossyã®ãƒšãƒ³ã‚®ãƒ³ã•ã„ã¨ &copy; Yossy</p>
  </footer>

  <script src="theme.js"></script>
  <script>
    const WORKER_URL = 'https://essay-proxy.yoshida-tom-ac.workers.dev';

    console.log('[Contact Form] Script loaded, initializing event listener...');

    const contactForm = document.getElementById('contact-form');
    if (!contactForm) {
      console.error('[Contact Form] ERROR: contact-form element not found!');
    } else {
      console.log('[Contact Form] contact-form element found, attaching submit listener');

      contactForm.addEventListener('submit', async function(e) {
        console.log('[Contact Form] Submit event fired');
        e.preventDefault();

        const submitBtn = document.querySelector('button[type="submit"]');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = 'ğŸ“¬ é€ä¿¡ä¸­â€¦';

        // ãƒ•ã‚©ãƒ¼ãƒ å€¤ã‚’å–å¾—
        const formData = {
          essayType: 'contact-form',
          name: document.getElementById('name').value,
          email: document.getElementById('email').value,
          school: document.getElementById('school').value,
          grade: document.getElementById('grade').value,
          university: document.getElementById('university').value,
          subject: document.getElementById('subject').value,
          message: document.getElementById('message').value,
        };

        console.log('[Contact Form] Form data:', formData);
        console.log('[Contact Form] Sending POST to:', WORKER_URL);

        try {
          // Worker ã« POST ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
          const response = await fetch(WORKER_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(formData)
          });

          console.log('[Contact Form] Response received:', response.status, response.statusText);

          if (!response.ok) {
            const error = await response.json();
            throw new Error(error.error || 'ãŠä¾¿ã‚Šã®é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ');
          }

          const result = await response.json();
          console.log('âœ… GitHub Issue ä½œæˆæˆåŠŸ:', result);

          // ãƒ•ã‚©ãƒ¼ãƒ ã‚’éè¡¨ç¤ºã«ã—ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
          document.getElementById('contact-form').style.display = 'none';
          document.getElementById('success-message').hidden = false;

          // ãƒšãƒ¼ã‚¸ã®ä¸Šéƒ¨ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
          window.scrollTo({ top: 0, behavior: 'smooth' });

        } catch (error) {
          console.error('âŒ ã‚¨ãƒ©ãƒ¼:', error.message);
          alert(`é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ:\n${error.message}`);
          submitBtn.disabled = false;
          submitBtn.textContent = originalText;
        }
      });
    }
  </script>

</body>
</html>
